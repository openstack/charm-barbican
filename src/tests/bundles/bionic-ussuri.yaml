local_overlay_enabled: False

series: bionic

machines:
  '0':
    constraints: mem=3072M
  '1':
  '2':
  '3':

applications:

  mysql:
    charm: ch:percona-cluster
    num_units: 1
    to:
      - '0'
    channel: 5.7/edge

  keystone:
    charm: ch:keystone
    num_units: 1
    options:
      openstack-origin: cloud:bionic-ussuri
    to:
      - '1'
    channel: ussuri/edge

  barbican:
    series: bionic
    charm: ../../../barbican.charm
    num_units: 1
    options:
      openstack-origin: cloud:bionic-ussuri
      debug: true
    to:
      - '2'

  rabbitmq-server:
    charm: ch:rabbitmq-server
    num_units: 1
    to:
      - '3'
    channel: 3.8/edge

relations:
- - mysql:shared-db
  - keystone:shared-db
- - mysql:shared-db
  - barbican:shared-db
- - keystone:identity-service
  - barbican:identity-service
- - rabbitmq-server:amqp
  - barbican:amqp
